from pithy import *
import json 

path = '/Users/j125mini/EASI/data/'

pat = '''20160212-ZPower-312LC-28mAh-pulsecathode-g1-1*
20160212-ZPower-312LC-28mAh-pulsecathode-g1-*7
20160212-ZPower-312LC-28mAh-pulsecathode-g2-1*
20160212-ZPower-312LC-28mAh-pulsecathode-g2-*7
20160212-ZPower-312LC-28mAh-pulseanode-g1-2*
20160212-ZPower-312LC-28mAh-pulseanode-g1-*8
20160212-ZPower-312LC-28mAh-pulseanode-g2-2*
20160212-ZPower-312LC-28mAh-pulseanode-g2-*8
20160212-ZPower-312LC-32mAh-pulsecathode-g1-3*
20160212-ZPower-312LC-32mAh-pulsecathode-g1-*9
20160212-ZPower-312LC-32mAh-pulsecathode-g2-3*
20160212-ZPower-312LC-32mAh-pulsecathode-g2-*9
20160212-ZPower-312LC-32mAh-pulseanode-g1-4*
20160212-ZPower-312LC-32mAh-pulseanode-g1-*10
20160212-ZPower-312LC-32mAh-pulseanode-g2-4*
20160212-ZPower-312LC-32mAh-pulseanode-g2-*10
20160212-ZPower-675LC-120mAh-pulsecathode-g1-5*
20160212-ZPower-675LC-120mAh-pulsecathode-g1-*11
20160212-ZPower-675LC-120mAh-pulsecathode-g2-5*
20160212-ZPower-675LC-120mAh-pulsecathode-g2-*11
20160212-ZPower-675HC-130mAh-pulsecathode-g1-6*
20160212-ZPower-675HC-130mAh-pulsecathode-g1-*12
20160212-ZPower-675HC-130mAh-pulsecathode-g2-6*
20160212-ZPower-675HC-130mAh-pulsecathode-g2-*12'''

#20160201 9:23 pm - ~348 reads

pat = pat.split('\n')

for nm in pat:
    tr = glob(path + "%s*TR*.json" % nm)
    tr.sort()
    pe = glob(path + "%s*PE*.json" % nm)
    pe.sort()
    
    print len(tr)
    print len(pe)
    
    bigdextr = []
    bigdexpe = []
    
    for i in tr:
        ts = i.split("_")[-1].replace(".json","")
        f = json.load(open(i))
        bigdextr.append(abs(array(f['amp'])-127))
    for i in pe:
        ts = i.split("_")[-1].replace(".json","")
        f = json.load(open(i))
        bigdexpe.append(abs(array(f['amp'])-127))
    
    subplot(211)
    bigdextr = array(bigdextr).transpose()
    pod = imshow(bigdextr,aspect="auto")
    ylabel('TR')
    title(nm)
    
    subplot(212)
    bigdexpe = array(bigdexpe).transpose()
    imshow(bigdexpe,aspect="auto")
    ylabel('PE')
    xlabel('index')
    
    showme()
    clf()